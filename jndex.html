<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>JumpMan</title>
    <style>

    #app{
      background-color: lightblue;
      width: 640px;
      height: 640px;
      margin: 0 auto;
      position: relative;
    }

    .genTile{
      background-color: lightblue;
      width: 80px;
      height: 80px;
      float: left;
    }

    .jumpManStyle{
      background-color: orange;
      height: 30px;
      width: 15px;
      position: absolute;
    }

    </style>
  </head>
  <body>

    <div id="app"></div>

    <script>

    const app = document.getElementById('app');
    const grav = 5;
    const speed = 4;
    let jumpMan = new Object;

    let backTile = new Array;

    function tileMaker(){
      for(var i = 0; i < 64 / 8; i++){
        for(var j = 0; j < 64 / 8; j++){
          const bT = new Object;
          if(i > 5){bT.color = 'green';
        }else{bT.color = 'lightblue'}
          backTile.push(bT);
        bT.topY = i * 80;
        bT.bottomY = (i+1) * 80;
        bT.leftX = j * 80;
        bT.rightX = (j+1)*80;
        }
      }
    }

    function mapBuilder(){
      for(var i = 0; i < backTile.length; i++){
        const divMan = document.createElement('div');
        if(backTile[i].color == 'green'){
          divMan.style.backgroundColor = 'green';
        }
        divMan.classList = 'genTile'
        app.appendChild(divMan);
      }
    }

    function charMaker(){
      jumpMan.color = 'orange';
      jumpMan.x = 640/2;
      jumpMan.y = 640/2;
      jumpMan.height = 10;
      jumpMan.width = 5;
    }

    function charBuilder(){
      const jm = document.createElement('div');
      jm.classList = 'jumpManStyle';
      jm.style.left = jumpMan.x+'px';
      jm.style.top = jumpMan.y+'px';
      jm.id = 'jumpManDiv';
      app.appendChild(jm);
    }

    function charRefresh(){
      charPhysics();
      let jm = document.getElementById('jumpManDiv');
      jm.style.left = jumpMan.x+'px';
      jm.style.top = jumpMan.y+'px';
    }

    function charPhysics(){
      let jmFall = true;
      for(var i = 0; i < backTile.length; i++){
        //console.log(jumpMan.y + ' | ' + backTile[i].topX  )
        if(jumpMan.y == (backTile[i].topY - 30) && backTile[i].color == 'green'){
          jmFall = false;
        }
      }
      if(jmFall == true){
        jumpMan.y += grav;
      }
    }

    function charControl(event){
      console.log(event)
      if(event.key == "ArrowRight"){
        jumpMan.x += speed;
      }
      else if(event.key == 'ArrowLeft'){
        jumpMan.x -= speed;
      }
    }

    (function init(){
      tileMaker();
      mapBuilder();
      charMaker();
      charBuilder();
    })()

    setInterval(charRefresh, 1000/30);

    document.addEventListener('keydown', charControl)

    console.log(backTile);

    </script>

  </body>
</html>
